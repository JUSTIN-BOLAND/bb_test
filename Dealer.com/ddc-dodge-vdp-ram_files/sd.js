var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},_SD;!function(e){var t=function(){function e(){}return e}();t.tagServerUrl="fcaus-tagging-server-prod.azurewebsites.net",t.scriptUrl="az850831.vo.msecnd.net/scripts",t.imageTagPath="1x1.gif",t.ajaxPostPath="data",t.forceSSL=!1,t.dataLayer="sdDataLayer",t.debug=!1,t.blockSendIfCookiesDisabled=!0,t.cookieDomainPeriods=2,e.Configuration=t;var r=function(){function e(){}return e}();r.version="1.12",r.cookieNamePrefix="_sd:",r.serializeEscapeChar="!",r.cookieMaxLength=4e3,r.userCookieName=r.cookieNamePrefix+"user",r.sessionCookieName=r.cookieNamePrefix+"session",r.errorPrefix="SD::",r.debugPrefix="[SD] ",r.loopFreqMs=100,r.pingFreqMs=3e4,r.considerIdleAfterMs=6e4,r.maxIdleMs=12e4,r.sessionTimeoutMs=54e4,r.pluginLoadTimeoutMs=2e3,r.publishCallbackTimeoutMs=1e3,e.Constants=r;var n=function(){function e(){}return e}();n.cacheBuster="cb",n.campaign="cmp",n.campaignType="cmpt",n.campaignName="cmpn",n.clientId="cl",n.colorDepth="d",n.debug="dbg",n.digAdAdId="daa",n.digAdCid="dac",n.digAdKeyword="dak",n.digAdProvider="dap",n.encoding="enc",n.eventCategory="ec",n.eventAction="ea",n.eventLabel="el",n.eventValue="ev",n.eventNonInteractive="eni",n.eVars="evars",n.flashVersion="fl",n.globalId="gid",n.hitType="ht",n.hitId="hid",n.javaEnabled="je",n.language="l",n.pageViewId="pid",n.props="props",n.providerId="prid",n.referrer="rf",n.resolution="rs",n.retailerId="rid",n.sdId="sdid",n.sessionId="sid",n.timestamp="ts",n.title="t",n.trace="sd_trace",n.url="u",n.userId="uid",n.version="v",n.viewportSize="vp",n.incomingCampaign="sd_campaign",n.incomingCampaignType="sd_campaign_type",n.incomingCampaignName="sd_campaign_name",n.incomingDigAdAdId="sd_digadid",n.incomingDigAdCid="sd_digadcid",n.incomingDigAdKeyword="sd_digadkeyword",n.incomingDigAdProvider="sd_digadprov",n.incomingTrace="sd_trace",n.incomingCrossDomainInfo="sd_xdinfo",n.incomingPlugins="sd_plugins",n.incomingReferrer="sd_referrer",e.Map=n;var i=function(){function e(){this._lastLoopTime=0,this._idleTimeMs=0,this._isSuspended=0,this._isPingDisabled=!1;var e=this;e._commandProcessor=new o(this);var t=b.getTimeInTicks();e._lastCmdTime=t,e._lastLoopTime=t;var r=b.getSD();if(r.sync=function(){this.sdSync(Array.prototype.slice.call(arguments))},"prerender"===document.visibilityState){var n=function(t){"visible"===document.visibilityState&&(b.removeEvent(document,"visibilitychange",n),e._start())};b.addEvent(document,"visibilitychange",n)}else e._start()}return e.prototype._process=function(e){var t=this,n=b.getTimeInTicks(),i=b.getSDQueue();if(i&&(!b.isHidden()||e))if(0!==i.length){for(;0!==i.length&&!t._isSuspended;)try{t._processItem(i.shift())}catch(o){b.error("Loop::Process error",o)}t._lastCmdTime=n}else e||0!==r.pingFreqMs&&!t._isPingDisabled&&t._idleTimeMs<r.considerIdleAfterMs&&t._lastCmdTime+r.pingFreqMs<b.getTimeInTicks()&&this.push(["send","ping"]);e||(t._idleTimeMs+=n-t._lastLoopTime,!t._isPingDisabled&&t._idleTimeMs>r.maxIdleMs&&(t._isPingDisabled=!0),t._lastLoopTime=n,window.setTimeout(function(){return t._process()},r.loopFreqMs))},e.prototype._start=function(){var e=this;window.setTimeout(function(){return e._process()},r.loopFreqMs);var t=function(t){e._idleTimeMs=0};b.addEvent(document,"mousemove",t),b.addEvent(document,"keydown",t),b.debug("SD "+r.version+" initialized.")},e.prototype._processItem=function(e){e&&e.length&&e.length>0&&(this._commandProcessor.process(e[0],Array.prototype.slice.call(e,1)),this._isPingDisabled&&(this._isPingDisabled=!1))},e.prototype.suspend=function(){this._isSuspended++},e.prototype.resume=function(){this._isSuspended>0&&this._isSuspended--},e.prototype.push=function(e){var t=b.getSDQueue();t&&t.push(e)},e.prototype.insert=function(e){var t=b.getSDQueue();t&&t.unshift(e)},e.prototype.insertBefore=function(e,t){var r=b.getSDQueue();if(r){for(var n=0;n<r.length&&r[n][0]!==e;n++);r.splice(n,0,t)}},e.prototype.getQueueSize=function(){var e=b.getSDQueue();return e?e.length:0},e.prototype.sd=function(e,t){e&&(this.push(e),e.length&&e.length>0&&"send"===e[0]&&t!==!0&&this._process(!0))},e.prototype.sdSync=function(e){this.sd(e,!0),this._process(!0)},e}();e.Loop=i;var o=function(){function e(e){this.loop=e,this._mapCmdToPipeline={},this._state={clientId:"",retailerId:"",providerId:"",userId:"",pageViewId:b.generateGuid(),props:{},eVars:{},campaign:"",campaignType:"",campaignName:"",digAdAdId:"",digAdCid:"",digAdKeyword:"",digAdProvider:"",dataLayer:""},this._coreCommands=[new c,new d,new p,new y,new f,new h,new g,new l,new v,new m,new u],this.setPlugins([],!1)}return e.prototype.getLoop=function(){return this.loop},e.prototype.getState=function(){return this._state},e.prototype.process=function(e,t){if("function"==typeof e)return void e();var n=this._mapCmdToPipeline[e.toLowerCase()];if(!n||0===n.length)throw new Error(r.errorPrefix+"Unknown command: "+e);for(var i=0;i<n.length;i++){var o=n[i].action.apply(n[i].plugin,t);if(o)break}},e.prototype.setPlugins=function(e,t){var r=this;e&&!b.isArray(e)&&(e=[e]),this._loadPlugins(e,function(e){var n;n=t&&r._plugins&&0!==r._plugins.length?r._plugins.concat(e):r._coreCommands.concat(e),n=b.uniqueArray(n),n.sort(function(e,t){return(t.priority||0)-(e.priority||0)}),r._plugins=n;var i={commandProcessor:r};r._mapCmdToPipeline={};for(var o=0;o<r._plugins.length;o++){"function"==typeof r._plugins[o].init&&r._plugins[o].init(i);for(var a in r._plugins[o])if("_"===a.substring(0,1)&&"function"==typeof r._plugins[o][a]){var s=a.substring(1).toLowerCase();r._mapCmdToPipeline[s]=r._mapCmdToPipeline[s]||[],r._mapCmdToPipeline[s].push({plugin:r._plugins[o],action:r._plugins[o][a]})}}})},e.prototype._loadPlugins=function(e,n){var i=this;e=b.uniqueArray(e);var o=e.length;if(0===o)return void n(e);for(var s=function(){o--,0===o&&n(e)},c=0;c<e.length;c++){var d=e[c];if("string"==typeof d){var u,p,l=d.indexOf("|");-1!==l?(u=d.substr(0,l),p=d.substr(l+1),-1===p.indexOf("//")&&(p="//"+p)):(u=d,p="//"+t.scriptUrl+"/sd_"+d+".js");var g=a.getPlugin(u);g?(e[c]=g,s()):(i.loop.suspend(),function(t,n,o){a.waitForLoad(n,function(r){r?e[t]=r:b.error("Plugin load failed: "+n),i.loop.resume(),s()},r.pluginLoadTimeoutMs);var c=document.createElement("script");c.src=o,c.async=!0;var d=document.body||document.getElementsByTagName("head")[0];d.appendChild(c)}(c,u,p))}else s()}},e}();e.CommandProcessor=o;var a=function(){function t(){}return t.registerPlugin=function(r,n){e.Utils.debug(r+" plugin loaded."),n&&(r=r.toLowerCase(),t._plugins[r]=n);var i=t._watchers[r];if(i){clearTimeout(i.timer);var o=t.getPlugin(r);i.callback(o),delete t._watchers[r]}},t.getPlugin=function(e){return e=e.toLowerCase(),t._plugins[e]},t.waitForLoad=function(e,r,n){e=e.toLowerCase(),t._watchers[e]={callback:r,timer:setTimeout(function(){var n=t.getPlugin(e);r(n)},n)}},t}();a._plugins={},a._watchers={},e.PluginContainer=a;var s=function(){function e(){this.priority=1}return e.prototype.init=function(e){this.commandProcessor=e.commandProcessor,this.state=this.commandProcessor.getState()},e.prototype.debug=function(e){if(e){var t=100;e+="";var r=this.state.dbg||"";r&&(e=r+","+e),e.length>t&&(e=e.substring(0,t)),this.state.dbg=e}},e}();e.Plugin=s;var c=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype._plugins=function(e,t){return this.commandProcessor.setPlugins(e,t||!1),!0},t}(s);e.PluginsCommand=c;var d=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype._create=function(){var e=b.getArgs(arguments,"clientId","retailerId","providerId"),t=e.clientId||"",n=e.retailerId||"",i=e.providerId||"",o=this.getQueryStringVariables();if(!(t&&n&&i||o.crossDomainInfo))throw new Error(r.errorPrefix+"Must specify clientId, retailerId and providerId when calling create.");this.state.clientId=t,this.state.retailerId=n,this.state.providerId=i,this.state.sdId||(this.state.sdId=b.generateRandomId());var a=w.readUserCookie();a.id||(a.id=b.generateGuid(),a.timestamp=b.getTimeInTicks()),this.state.userId=a.id,w.writeUserCookie(a);var s=w.readSessionCookie(),c=!1;for(var d in o)if(o.hasOwnProperty(d)){var u=o[d];"trace"===d?u&&(s.trace=b.stringToBool(u),c=!0):"plugins"===d?u&&(s.plugins=u.split(","),c=!0):this.state[d]=u}c&&w.writeSessionCookie(s);var p=[];s.trace&&p.push("trace"),0!==s.plugins.length&&(p=p.concat(s.plugins));for(var l="",g=l.split(","),f=0;f<g.length;f++)g[f]&&p.push(g[f]);return 0!==p.length&&this.commandProcessor.getLoop().insertBefore("send",["plugins",p,!0]),o.crossDomainInfo&&this.commandProcessor.getLoop().insertBefore("send",["xdImport",o.crossDomainInfo]),!0},t.prototype.getQueryStringVariables=function(){var e={},t=b.getQueryParams(function(e){return e.toLowerCase()});return e.campaign=t[n.incomingCampaign],e.campaignType=t[n.incomingCampaignType],e.campaignName=t[n.incomingCampaignName],e.digAdAdId=t[n.incomingDigAdAdId],e.digAdCid=t[n.incomingDigAdCid],e.digAdKeyword=t[n.incomingDigAdKeyword],e.digAdProvider=t[n.incomingDigAdProvider],e.crossDomainInfo=t[n.incomingCrossDomainInfo],e.plugins=t[n.incomingPlugins],e.trace=t[n.incomingTrace],e.referrer=t[n.incomingReferrer],e},t}(s);e.CreateCommand=d;var u=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype._link=function(){var e=b.getArgs(arguments,"targetUrl","useHash"),t=function(e){document.location.href=e};return this.commandProcessor.getLoop().insert(["getLinkerUrl",{targetUrl:e.targetUrl,useHash:e.useHash,callback:t}]),!0},t.prototype._linkByPost=function(){var e=b.getArgs(arguments,"formObject","useHash"),t=e.formObject;if(t&&t.action){var r=function(t){e.formObject.action=t};this.commandProcessor.getLoop().insert(["getLinkerUrl",{targetUrl:e.formObject.action,useHash:e.useHash,callback:r}])}return!0},t.prototype._getLinkerUrl=function(){var e=b.getArgs(arguments,"targetUrl","useHash","callback");if(!e.callback)return!0;var t=function(t){var r=n.incomingCrossDomainInfo+"="+t,i=e.useHash?null:r,o=e.useHash?r:null;e.callback(b.addParamsToUrl(e.targetUrl,i,o))};return this.commandProcessor.getLoop().insert(["xdExport",t]),!0},t.prototype._xdExport=function(){var e=this,t=b.getArgs(arguments,"callback");if(!t.callback)return!0;var r=function(){n=w.readSessionCookie();var r=[e.state.clientId,e.state.providerId,e.state.retailerId,e.state.userId,n.id,n.expire,e.state.pageViewId].join("|");r=encodeURIComponent(r),t.callback(r)},n=w.readSessionCookie();return!n.id||n.expire<b.getTimeInTicks()?(this.commandProcessor.getLoop().insert([r]),this.commandProcessor.getLoop().insert(["send","pageview"])):r(),!0},t.prototype._xdImport=function(){var e=b.getArgs(arguments,"data");if(e.data){var t=e.data.split("|");if(t&&7===t.length){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=parseInt(t[5],10),d=t[6];this.state.clientId=n,this.state.retailerId=o,this.state.providerId=i,this.state.userId=a;var u=w.readUserCookie();u.id=a,u.timestamp=b.getTimeInTicks(),w.writeUserCookie(u);var p=w.readSessionCookie();c>b.getTimeInTicks()&&(p.id=s,p.expire=b.getTimeInTicks()+r.sessionTimeoutMs,w.writeSessionCookie(p),this.state.pageViewId=d),this.state.isXdImport=!0}}return!0},t}(s);e.CrossDomainCommands=u;var p=function(e){function i(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(i,e),i.prototype._send=function(){var e=b.getArgs(arguments,"hitType","eventCategory","eventAction","eventLabel","eventValue","eventNonInteractive","hitCallback");e.hitType=(e.hitType||"").toLowerCase();var i=e.hitType;if(!i){var o=this.getDataLayerEvents(!0);if(0===o.length)return e.hitCallback&&e.hitCallback(),!0;i="event",e.hitType="event",e.eventCategory=o[0].eventCategory,e.eventAction=o[0].eventAction,e.eventLabel=o[0].eventLabel,e.eventValue=o[0].eventValue,e.eventNonInteractive=o[0].eventNonInteractive}var a="pageview"===i,s="ping"===i,c="event"===i;if(t.blockSendIfCookiesDisabled&&!w.getCookieSupport().session&&!this.state.isXdImport)return b.error("Session cookies disabled, skipping send."),e.hitCallback&&e.hitCallback(),!0;if(this.validate(e)){a&&(this.state.pageViewId=b.generateGuid());var d=this.state.clientId,u=this.state.retailerId,p=this.state.providerId,l=w.readSessionCookie();if(!l.id||l.expire<b.getTimeInTicks()){if(!l.id){var g=this.state.sessionCookie;if(g&&g.expire>b.getTimeInTicks())return b.error("Session cookie read failed, skipping send."),w.getCookieSupport().session=!1,e.hitCallback&&e.hitCallback(),!0}if(!a)return s||this.commandProcessor.getLoop().insert(["send"].concat(Array.prototype.slice.call(arguments))),this.commandProcessor.getLoop().insert(["send","pageview"]),!0;l.id=b.generateGuid()}var f=b.getTimeInTicks()+r.sessionTimeoutMs;l.expire=f,w.writeSessionCookie(l),this.state.sessionCookie={id:l.id,expire:l.expire};var h={};if(h[n.hitType]=i,h[n.clientId]=d,h[n.retailerId]=u,h[n.providerId]=p,h[n.userId]=this.state.userId,h[n.sessionId]=l.id,h[n.pageViewId]=this.state.pageViewId,h[n.hitId]=b.generateGuid(),h[n.sdId]=this.state.sdId,!s){var o=this.getDataLayerEvents();this.setPropsForDataLayerFields(),h[n.eVars]=C.dictionaryToString(k.getEVars(this.state)),h[n.props]=C.dictionaryToString(_.getProps(this.state)),h[n.campaign]=this.state.campaign||"",h[n.campaignName]=this.state.campaignName||"",h[n.campaignType]=this.state.campaignType||"",h[n.digAdAdId]=this.state.digAdAdId||"",h[n.digAdCid]=this.state.digAdCid||"",h[n.digAdKeyword]=this.state.digAdKeyword||"",h[n.digAdProvider]=this.state.digAdProvider||"",this.state.campaign="",this.state.campaignName="",this.state.campaignType="",this.state.digAdAdId="",this.state.digAdCid="",this.state.digAdKeyword="",this.state.digAdProvider=""}if(c){var v=e.eventCategory||"";h[n.eventCategory]=v,h[n.eventAction]=e.eventAction||"",h[n.eventLabel]=e.eventLabel||"",h[n.eventValue]=parseInt(e.eventValue||"0",10),h[n.eventNonInteractive]=e.eventNonInteractive?"true":"false";for(var m=v.toLowerCase(),y=o.length-1;y>=0;y--)o[y].eventCategory.toLowerCase()===m&&o.splice(y,1)}if(s||this.addDebugData(h),this.addBrowserData(h),a&&this.state.referrer){var I=this.state.referrer;"http"!==I.toLowerCase().substring(0,4)&&(I="http://"+I),h[n.referrer]=I,this.state.referrer=null}if(this.publish(h,e.hitCallback),!s)for(var y=0;y<o.length;y++)this.commandProcessor.getLoop().push(["send","event",o[y].eventCategory,o[y].eventAction,o[y].eventLabel,o[y].eventValue,o[y].eventNonInteractive])}return!0},i.prototype.validate=function(e){var t=e.hitType;if("pageview"!=t&&"ping"!=t&&"event"!=t)throw new Error(r.errorPrefix+"Unknown hit type: "+t);if("event"==t&&!e.eventCategory)throw new Error(r.errorPrefix+"Event category required when firing event.");if(!this.state.clientId)throw new Error(r.errorPrefix+"ClientId not set.");if(!this.state.retailerId)throw new Error(r.errorPrefix+"RetailerId not set.");if(!this.state.providerId)throw new Error(r.errorPrefix+"ProviderId not set.");if(!this.state.userId)throw new Error(r.errorPrefix+"UserId not set.");return!0},i.prototype.publish=function(e,t){this.commandProcessor.getLoop().insert(["publish",{params:e,hitCallback:t}])},i.prototype.getDataLayerEvents=function(e){var r=[],n=window[t.dataLayer];if(n&&n.events){var i=n.events;if("string"==typeof i&&(i=i.split(",")),b.isArray(i))for(var o={},a=0;a<i.length;a++)if(i[a]&&"string"==typeof i[a]){var s=i[a].split("|"),c=b.trim(s[0]),d=c.toLowerCase();if(!o[d]){o[d]=!0;var u={eventCategory:b.trim(s[0]),eventAction:s[1]||"",eventLabel:s[2]||"",eventValue:s[3]||"",eventNonInteractive:s[4]||""};r.push(u)}}e||delete n.events}return r},i.prototype.setPropsForDataLayerFields=function(){var e,r=this.state.dataLayer,n=b.flatten(window[t.dataLayer]),i=b.diff(r,n);for(e=0;e<i.adds.length;e++)_.setProp(this.state,i.adds[e][0],i.adds[e][1]);for(e=0;e<i.changes.length;e++)_.setProp(this.state,i.changes[e][0],i.changes[e][2]);this.state.dataLayer=n},i.prototype.addDebugData=function(e){this.state.dbg&&(e[n.debug]=this.state.dbg+"",this.state.dbg="")},i.prototype.addBrowserData=function(e){e[n.cacheBuster]=b.generateRandomId(),e[n.colorDepth]=window.screen.colorDepth+"-bit",e[n.encoding]=document.characterSet||document.charset,e[n.flashVersion]=this.getFlashVersion(),e[n.javaEnabled]=navigator&&"function"==typeof navigator.javaEnabled&&navigator.javaEnabled()||!1,e[n.language]=(navigator&&(navigator.language||navigator.browserLanguage)||"").toLowerCase(),e[n.referrer]=document.referrer,e[n.resolution]=window.screen.width+"x"+window.screen.height,e[n.timestamp]=b.getTimeInTicks(),e[n.title]=document.title,e[n.url]=document.location.href,e[n.version]=r.version,e[n.viewportSize]=this.getViewportSize()},i.prototype.getViewportSize=function(){var e="",t=[0,0],r=document.body&&document.body.clientWidth&&document.body.clientHeight,n=document.documentElement;return n&&n.clientWidth&&n.clientHeight&&("CSS1Compat"===document.compatMode||!r)?t=[n.clientWidth,n.clientHeight]:r&&(t=[document.body.clientWidth,document.body.clientHeight]),t[0]&&t[1]&&(e=t.join("x")),e},i.prototype.getFlashVersion=function(){var e,t,r;if((r=(r=window.navigator)?r.plugins:null)&&r.length)for(var n=0;n<r.length&&!t;n++){var i=r[n];-1<i.name.indexOf("Shockwave Flash")&&(t=i.description)}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),t=e.GetVariable("$version")}catch(o){}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),t="WIN 6,0,21,0",e.AllowScriptAccess="always",t=e.GetVariable("$version")}catch(a){}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),t=e.GetVariable("$version")}catch(s){}return t&&(e=t.match(/[\d]+/g))&&3<=e.length&&(t=e[0]+"."+e[1]+" r"+e[2]),t||""},i}(s);e.SendCommand=p;var l=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype._setProp=function(e,t){return _.setProp(this.state,e,t),!0},t.prototype._getProp=function(e,t){return t(_.getProp(this.state,e)),!0},t}(s);e.PropsCommands=l;var g=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype._setEVar=function(e,t){return k.setEVar(this.state,e,t),!0},t.prototype._getEVar=function(e,t){return t(k.getEVar(this.state,e)),!0},t}(s);e.EVarsCommands=g;var f=function(e){function r(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(r,e),r.prototype._config=function(e,r){return e in t&&(t[e]=r),!0},r}(s);e.ConfigCommand=f;var h=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype._debug=function(e){return b.debug(e),!0},t}(s);e.DebugCommand=h;var v=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype.init=function(t){var r=this;e.prototype.init.call(this,t),b.ready(function(){return r.commandProcessor.getLoop().insert(["trackLinks"])})},t.prototype._trackLinks=function(){var e=this;if(document&&document.getElementsByTagName){var t=document.getElementsByTagName("a");if(t&&t.length)for(var r=0;r<t.length;r++)!function(){if(t[r]&&t[r].getAttribute&&!t[r]._sdLink){t[r]._sdLink=!0;var n=t[r].getAttribute("data-sd-event");if(n){for(var i=(t[r].getAttribute("data-sd-event-link")||"").toLowerCase(),o=t[r].getAttribute("data-sd-event-set-prop")||"",a=t[r].getAttribute("data-sd-event-set-evar")||"",s=n.split(","),c=0,d=0,u=0;u<s.length;u++)!function(){var n=s[u].split("|");if(n&&n.length>0){var p=t[r].href;if(p&&"javascript:"!==p.substring(0,11)){c++;var l=n[0],g=n[1]||"",f=n[2]||"",h=n[3]||"",v=n[4]||"";b.addEvent(t[r],"click",function(t){b.preventDefault(t),b.stopPropagation(t);var r={hitType:"event",eventCategory:l,eventAction:g,eventLabel:f,eventValue:h,eventNonInteractive:v,hitCallback:function(){if(d--,!d){d=c;var t=function(e){document.location.href=e};"false"!==i?e.commandProcessor.getLoop().insert(["getLinkerUrl",{targetUrl:p,useHash:"hash"===i,callback:t}]):t(p)}}};if(e.commandProcessor.getLoop().insert(["send",r]),o)for(var n=o.split(","),s=0;s<n.length;s++)if(n[s]){var u=n[s].split("|");u.length>=2&&e.commandProcessor.getLoop().insert(["setProp",u[0],u.slice(1).join("|")])}if(a)for(var m=a.split(","),s=0;s<m.length;s++)if(m[s]){var u=m[s].split("|");u.length>=2&&e.commandProcessor.getLoop().insert(["setEVar",u[0],u.slice(1).join("|")])}})}else b.error("data-sd-event not supported for Javascript links.")}}();d=c}}}()}},t}(s);e.TrackLinksCommand=v;var m=function(e){function t(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(t,e),t.prototype.init=function(t){var r=this;e.prototype.init.call(this,t),b.ready(function(){return r.commandProcessor.getLoop().insert(["trackIFrames"])})},t.prototype._trackIFrames=function(){var e=this;if(document&&document.getElementsByTagName){var t=document.getElementsByTagName("iframe");if(t&&t.length)for(var r=0;r<t.length;r++)!function(){var n=t[r];if(n&&n.getAttribute&&!n._sdIFrame){n._sdIFrame=!0;var i=n.getAttribute("src"),o=null!==n.getAttribute("data-sd-iframe");if(o&&i&&"about:blank"!==i){var a=function(e){n.src=e};e.commandProcessor.getLoop().insert(["getLinkerUrl",{targetUrl:i,callback:a}])}}}()}},t}(s);e.TrackIFramesCommand=m;var y=function(e){function n(){var t=e.apply(this,arguments)||this;return t.priority=0,t}return __extends(n,e),n.prototype._publish=function(){var e=b.getArgs(arguments,"params","hitCallback"),t=e.params,n=e.hitCallback,i=this.paramsToString(t);if(n=n?this.wrapCallbackWithTimeout(n,r.publishCallbackTimeoutMs):function(){},i.length<=2036)this.sendWithImageTag(i,n);else{if(!(i.length<=8192))throw new Error(r.errorPrefix+"Payload >8192 bytes not supported.");navigator.userAgent.indexOf("Firefox")>0&&![].reduce?n():this.sendWithXmlHttpRequest(i,n)||this.sendWithXDomainRequest(i,n)||this.sendWithIFrame(i,n)||n()}return!0},n.prototype.wrapCallbackWithTimeout=function(e,t){var r=!1,n=0,i=function(t){n&&(window.clearTimeout(n),n=0),r||(r=!0,e())};return n=window.setTimeout(function(){return i(!0)},t),i},n.prototype.sendWithImageTag=function(e,r){var n=this.getProtocol()+"//"+t.tagServerUrl+"/"+t.imageTagPath+"?"+e,i=document.createElement("img");return i.width=1,i.height=1,i.src=n,i.onload=i.onerror=function(){i.onload=null,i.onerror=null,r()},!0},n.prototype.sendWithXmlHttpRequest=function(e,r){if("undefined"==typeof window.XMLHttpRequest)return!1;var n=new window.XMLHttpRequest;return"withCredentials"in n?(n.open("POST",this.getProtocol()+"//"+t.tagServerUrl+"/"+t.ajaxPostPath,!0),n.withCredentials=!0,n.setRequestHeader("Content-Type","text/plain"),n.onreadystatechange=function(){4===n.readyState&&(r(),n=null)},n.send(e),!0):!1},n.prototype.sendWithXDomainRequest=function(e,r){if("undefined"==typeof window.XDomainRequest)return!1;var n=new window.XDomainRequest;return n.open("POST",this.getProtocol()+"//"+t.tagServerUrl+"/"+t.ajaxPostPath),n.onerror=function(){return r()},n.onload=function(){return r()},n.send(e),!0},n.prototype.sendWithIFrame=function(e,r){var n=this;if(!document.body)return window.setTimeout(function(){return n.sendWithIFrame(e,r)},100),!0;e=encodeURIComponent(e);var i;try{i=document.createElement('<iframe name="'+e+'"></iframe>')}catch(o){i=document.createElement("iframe"),i.name=e}i.height="0",i.width="0",i.style.display="none",i.style.visibility="hidden";var a=n.getProtocol()+"//"+t.tagServerUrl+"/iframe.aspx#"+encodeURIComponent(document.location.protocol+"//"+document.location.host+"/favicon.ico"),s=function(){i.src="",i.parentNode&&i.parentNode.removeChild(i)};b.addEvent(document,"beforeunload",s);var c=!1,d=0,u=function(){if(!c){try{if(d>9||i.contentWindow.location.host===document.location.host)return c=!0,s(),b.removeEvent(document,"beforeunload",s),r()}catch(e){}d++,setTimeout(u,200)}};return b.addEvent(i,"load",u),document.body.appendChild(i),i.src=a,!0},n.prototype.getProtocol=function(){return t.forceSSL||"https:"===document.location.protocol?"https:":"http:"},n.prototype.paramsToString=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"="+encodeURIComponent(""+e[r]));return t.join("&")},n}(s);e.PublishCommand=y;var w=function(){function e(){}return e.getCookieSupport=function(){return e._cookieSupport},e.readUserCookie=function(){var t={id:"",version:0,timestamp:0},n=e.readCookie(r.userCookieName);if(n){var i=n.split(":");i&&3===i.length&&(t.id=i[0],t.version=parseInt(i[1],10),t.timestamp=parseInt(i[2],10))}return t},e.writeUserCookie=function(n){var i=[n.id,r.version,n.timestamp],o=i.join(":"),a=new Date,s=document.domain.split(".").slice(0-t.cookieDomainPeriods).join(".");return a.setFullYear(a.getFullYear()+1),e.writeCookie(r.userCookieName,o,{expires:a,domain:s})},e.readSessionCookie=function(){var t={id:"",trace:!1,expire:0,plugins:[]},n=e.readCookie(r.sessionCookieName);if(n){var i=n.split(":");i&&4===i.length&&(t.id=i[0],t.trace="Y"===i[1],t.expire=parseInt(i[2],10),t.plugins=0!==i[3].length?i[3].split(","):[])}return t},e.writeSessionCookie=function(t){var n=[t.id,t.trace?"Y":"N",t.expire,t.plugins.join(",")],i=n.join(":");return e.writeCookie(r.sessionCookieName,i)},e.readCookies=function(t){var r={};if(!t){var n=e._cookieJar;for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])}for(var o=document.cookie.split(";"),a=0;a<o.length;a++){var s=o[a].indexOf("="),c=b.trim(o[a].substring(0,s)),d=decodeURIComponent(b.trim(o[a].substring(s+1)));r[c]=d}return r},e.readCookie=function(t,r){var n=e.readCookies(r),i=n[t]||"";return i},e.writeCookie=function(t,r,n){n=n||{};var i=r,o=e._cookieSupport;if(o.persisted||(n.domain=null,n.expires=null),o.persisted||o.session){i=encodeURIComponent(r);var a=t+"="+i;a+="; path="+(n.path||"/"),n.expires&&(a+="; expires="+n.expires.toUTCString()),n.domain&&"localhost"!==n.domain&&(a+="; domain="+n.domain),document.cookie=a;var s=e.readCookie(t,!0);if(s!==r){var c=n.expires?"Persisted":"Session";if(b.error(c+" cookie write failed, N["+t+"], E["+(r||"")+"], A["+(s||"")+"]"),n.expires)return o.persisted=!1,e.writeCookie(t,r,n);o.session=!1}}var d=e._cookieJar;return d[t]=i,!0},e}();w._cookieJar={},w._cookieSupport={persisted:!0,session:!0},e.Cookies=w;var b=function(){function e(){}return e.addEvent=function(e,t,r){try{e.addEventListener?e.addEventListener(t,r):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}catch(n){}},e.removeEvent=function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=null},e.ready=function(e){var t=!1,r=!0,n=window,i=n.document,o=i.documentElement,a=i.addEventListener,s=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",d=a?"":"on",u=function(r){"readystatechange"==r.type&&"complete"!=i.readyState||(("load"==r.type?n:i)[c](d+r.type,u,!1),!t&&(t=!0)&&e.call(n,r.type||r))},p=function(){try{o.doScroll("left")}catch(e){return void setTimeout(p,50)}u("poll")};if("complete"==i.readyState)e.call(n,"lazy");else{if(!a&&o.doScroll){try{r=!n.frameElement}catch(l){}r&&p()}i[s](d+"DOMContentLoaded",u,!1),i[s](d+"readystatechange",u,!1),n[s](d+"load",u,!1)}},e.preventDefault=function(e){e.preventDefault?e.preventDefault():window.event?window.event.returnValue=!1:e.returnValue=!1},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e.isHidden=function(){return void 0===e._isHidden&&e._monitorHidden(),e._isHidden},e._monitorHidden=function(){var t="hidden",r=function(r){var n=!1,i=!0,o={focus:n,focusin:n,pageshow:n,blur:i,focusout:i,pagehide:i};r=r||window.event,r.type in o?e._isHidden=o[r.type]:e._isHidden=document[t]};t in document?document.addEventListener("visibilitychange",r):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",r):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",r):(t="msHidden")in document?document.addEventListener("msvisibilitychange",r):"onfocusin"in document?document.onfocusin=document.onfocusout=r:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=r,r({type:"visible"===document.visibilityState?"focus":"blur"})},e.generateGuid=function(){if(!e._rng){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues)try{var r=new Uint8Array(16);e._rng=function(){return t.getRandomValues(r),Array.prototype.slice.call(r)}}catch(n){}if(!e._rng){var i=new Array(16);e._rng=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}}var o=e._rng();o[6]=15&o[6]|64,o[8]=63&o[8]|128;for(var a="",s=0;s<o.length;s++)a+=(o[s]+256).toString(16).substr(1);return a.substring(0,8)+"-"+a.substring(8,12)+"-"+a.substring(12,16)+"-"+a.substring(16,20)+"-"+a.substring(20,32)},e.generateRandomId=function(){return(e.getTimeInTicks()+Math.floor(1e4*Math.random()+1)).toString(36)},e.getTimeInTicks=function(){return 1*new Date},e.trim=function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},e.extend=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=Array.prototype.slice.call(arguments,1),i=0;i<n.length;i++)if(n[i])for(var o in n[i])e[o]=n[i][o];return e},e.getSD=function(){var t=e.getSDName(),r=window[t];return r||e.error("Utils::getSD - "+t+" not found."),r},e.getSDName=function(){var e=window.ShiftAnalyticsObject||"sd";return e},e.getSDQueue=function(){var t=e.getSD(),r=null;return t&&((r=t.q)||(r=t.q=[])),r},e.getArgs=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={};e=Array.prototype.slice.call(e||[],0);var i={};"object"==typeof e[e.length-1]&&(i=e[e.length-1],e=e.slice(0,e.length-1));for(var o=0;o<t.length;o++)n[t[o]]=i[t[o]]||e[o];return n},e.debug=function(e){t.debug&&console&&console.log&&console.log(r.debugPrefix+e)},e.error=function(e,t){console&&console.error&&(t?console.error(r.errorPrefix+e,t):console.error(r.errorPrefix+e))},e.getQueryParams=function(e){for(var t,r=/\+/g,n=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(r," "))},o=[window.location.search.substring(1),window.location.hash.substring(1)],a={},s=0;s<o.length;s++)for(var c=o[s];t=n.exec(c);){var d=i(t[1]);e&&(d=e(d)),a[d]=i(t[2])}return a},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isDate=function(e){return e instanceof Date&&!isNaN(e.valueOf())},e.arrayIndexOf=function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},e.keys=function(e){if("object"==typeof e&&e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}return[]},e.attachSyncCommands=function(e){e.getLinkerUrl=function(t,r){var n="";return e.sync("getLinkerUrl",t,r,function(e){return n=e}),n},e.linkByPost=function(t,r){e.sync("linkByPost",t,r)},e.link=function(t,r){e.sync("link",t,r)}},e.addParamsToUrl=function(e,t,r){var n=document.createElement("a");if(n.href=e,t){var i=n.search;i=i?i+"&":"?",i+=t,n.search=i}if(r){var i=n.hash;i=i?i+"&":"#",i+=r,n.hash=i}return n.href},e.stringToBool=function(e){return e=e||"",-1!=="Y1T".indexOf(e.toUpperCase().charAt(0))},e.uniqueArray=function(e){var t=[];if(e&&0!==e.length)for(var r=0;r<e.length;r++){for(var n=!1,i=0;i<t.length;i++)if(t[i]===e[r]){n=!0;break}n||t.push(e[r])}return t},e.flatten=function(t,r,n){var i={};if(t&&"object"==typeof t){var o=10;r=r||[],n=n||0,r.push(t);for(var a in t)if(t.hasOwnProperty(a)){var s=t[a],c=typeof s;if("function"===c&&(s=s(),c=typeof s),null!==s&&void 0!==s||(s=""),"number"===c&&isNaN(s)&&(s="0"),"object"===c){if(e.isDate(s))i[a]=s.getTime().toString();else if(o>=n+1&&-1===e.arrayIndexOf(r,s)){var d=e.flatten(s,r,n+1);for(var u in d)d.hasOwnProperty(u)&&(i[a+"."+u]=d[u])}}else i[a]=s.toString()}}return i},e.diff=function(t,r){t=t||{},r=r||{};for(var n=e.keys(t).sort(),i=e.keys(r).sort(),o=[],a=[],s=[],c=0,d=0,u=n.length,p=i.length;u>c&&p>d;){var l=n[c],g=i[d],f=t[l],h=r[g];g>l?(a.push([l,f]),c++):l===g?(f!==h&&s.push([g,f,h]),c++,
d++):(o.push([g,h]),d++)}for(;u>c;){var l=n[c],f=t[l];a.push([l,f]),c++}for(;p>d;){var g=i[d],h=r[g];o.push([g,h]),d++}return{adds:o,removes:a,changes:s}},e}();b._rng=null,e.Utils=b;var C=function(){function e(){}return e.escape=function(e){return e=(e||"")+"",e.replace(new RegExp("\\"+r.serializeEscapeChar,"g"),r.serializeEscapeChar+r.serializeEscapeChar)},e.unescape=function(e){return e.replace(new RegExp("\\"+r.serializeEscapeChar+"(.)","g"),"$1")},e.dictionaryToString=function(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(e.escape(i)+r.serializeEscapeChar+"2"+e.escape(t[i]));return n.join(r.serializeEscapeChar+"1")},e.stringToDictionary=function(t){var n={};if(t){var i=t.split(r.serializeEscapeChar+"1"),o=0;for(o=0;o<i.length;o++){var a=i[o].split(r.serializeEscapeChar+"2");if(2===a.length){var s=e.unescape(a[0]),c=e.unescape(a[1]);n[s]=c}}}return n},e}();e.Serializer=C;var _=function(){function e(){}return e.getProp=function(e,t){return e.props[t]},e.setProp=function(e,t,r){e.props[t]=r},e.getProps=function(e){var t=e.props;return e.props={},t},e}();e.Props=_;var k=function(){function e(){}return e.getEVar=function(e,t){return e.eVars[t]},e.setEVar=function(e,t,r){e.eVars[t]=r},e.getEVars=function(e){var t=e.eVars;return e.eVars={},t},e}();e.EVars=k}(_SD||(_SD={})),function(){var e="_SD::StartCount";if(window[e]=window[e]||0,window[e]++,1===window[e]){var t="ShiftAnalyticsObject";window[t]||(window[t]="sd");var r=_SD.Utils.getSDQueue(),n=_SD.Utils.getSDName(),i=null;for(window[n]=function(){i.sd(Array.prototype.slice.call(arguments))},i=new _SD.Loop;0!==r.length;){var o=r.shift();i.push(o)}i.sdSync();var a=_SD.Utils.getSD();_SD.Utils.attachSyncCommands(a)}else console&&console.error&&console.error("SD.js loaded more than once.")}();