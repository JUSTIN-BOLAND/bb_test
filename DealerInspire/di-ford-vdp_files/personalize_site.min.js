var Utils={extend:function(a,b){if(b=JSON.parse(JSON.stringify(b)),"string"==typeof a)return b;var c,d;for(var c in a)d=a[c],a.hasOwnProperty(c)&&void 0!==d&&(b[c]=d);return b},queue:function(){function b(){var c=a.shift();c&&c(b)}var a=[];return function(c){a.push(c),1==a.length&&b()}}(),setcss:function(){function c(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(a,b){return b.toUpperCase()})}function d(b){var c=document.body.style;if(b in c)return b;for(var f,d=a.length,e=b.charAt(0).toUpperCase()+b.slice(1);d--;)if(f=a[d]+e,f in c)return f;return b}function e(a){return a=c(a),b[a]||(b[a]=d(a))}function f(a,b,c){b=e(b),a.style[b]=c}var a=["Webkit","O","Moz","ms"],b={};return function(a,b){var d,e,c=arguments;if(2==c.length)for(d in b)e=b[d],void 0!==e&&b.hasOwnProperty(d)&&f(a,d,e);else f(a,c[1],c[2])}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},toBarPerc:function(a){return 100*(-1+a)},hasClass:function(a,b){var c="string"==typeof a?a:Utils.classList(a);return c.indexOf(" "+b+" ")>=0},addClass:function(a,b){var c=Utils.classList(a),d=c+b;Utils.hasClass(c,b)||(a.className=d.substring(1))},removeClass:function(a,b){var d,c=Utils.classList(a);Utils.hasClass(a,b)&&(d=c.replace(" "+b+" "," "),a.className=d.substring(1,d.length-1))},showEl:function(a){Utils.setcss(a,{display:"block"})},hideEl:function(a){Utils.setcss(a,{display:"none"})},classList:function(a){return(" "+(a.className||"")+" ").replace(/\s+/gi," ")},removeElement:function(a){a&&a.parentNode&&a.parentNode.removeChild(a)}};!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.Mprogress=b()}("undefined"!=typeof window?window:this,function(){"use strict";var a={template:1,parent:"body",start:!1,minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800},b="99",c=500,d=1500,e='[role="mpbar"]',f='[role="bufferBar"]',g='[role="dashed"]',h={determinate:'<div class="deter-bar" role="mpbar1"><div class="peg"></div></div><div class="bar-bg"></div>',buffer:'<div class="deter-bar" role="mpbar2"><div class="peg"></div></div><div class="buffer-bg" role="bufferBar"></div><div class="mp-ui-dashed" role="dashed"></div>',indeterminate:'<div class="indeter-bar" role="mpbar3"></div><div class="bar-bg"></div>',query:'<div class="query-bar" role="mpbar4"><div class="peg"></div></div><div class="bar-bg"></div>'},i={},j=function(b){var c=Utils.extend(b,a),d=c.parent+c.template,e=i[d]||"";return e||(e=new k(c),i[d]=e),"string"==typeof b&&"function"==typeof e[b]?e[b]():c.start&&e.start(),e},k=function(a){this.options=a||{},this.status=null,this.bufferStatus=null,this._inst=MProgress_instances++};return k.prototype={version:"0.1.0",constructor:k,start:function(){function f(){setTimeout(function(){a.status&&(a._trickle(),f())},a.options.trickleSpeed)}if(this.status||this._isBufferStyle()||this.set(0),this._isIndeterminateStyle()||this._isQueryStyle())return this;var a=this;if(this._isBufferStyle()&&!this.bufferStatus){var b=this._render(),d=b.querySelector(g),e=b.querySelector(this._getCurrSelector());Utils.hideEl(e),Utils.hideEl(d),this.setBuffer(0).setBuffer(1),setTimeout(function(){Utils.showEl(d),Utils.showEl(e),a.set(0).setBuffer(0)},c)}return this.options.trickle&&f(),this},end:function(a){if(!a&&!this.status)return this;var b=this,e=this.options.speed,f=this._getRenderedId();if(this._isBufferStyle()&&a)return this.set(0).set(1);if(this._isIndeterminateStyle())return!this._isRendered()&&a&&(this.set(0),f=this._getRenderedId(),e=c),Utils.setcss(f,{transition:"none",opacity:1}),f.offsetWidth,setTimeout(function(){Utils.setcss(f,{transition:"all "+e+"ms linear",opacity:0}),setTimeout(function(){b._remove()},e)},e),this;if(this._isQueryStyle()){if(this._isRendered()){var g=f.querySelector(this._getCurrSelector());return Utils.addClass(g,"end"),setTimeout(function(){b._remove()},d),this}if(a)return this.set(0),f=this._getRenderedId(),setTimeout(function(){b._remove()},d),this}return this.inc(.3+.5*Math.random()).set(1)},set:function(a){return a=Utils.clamp(a,this.options.minimum,1),this.status=1===a?null:a,this._setProgress(this._getCurrSelector(),a),this},setBuffer:function(a){return a=Utils.clamp(a,this.options.minimum,1),this.bufferStatus=1===a?null:a,this._setProgress(f,a),this},inc:function(a){var b=this.status,c=this.bufferStatus;return b?(b=this._getRandomNum(b,a),this._isBufferStyle()&&(c=this._getRandomNum(c>b?c:b+.1,a),this.setBuffer(c)),this.set(b)):this.start()},_trickle:function(){return this.inc(Math.random()*this.options.trickleRate)},_render:function(a){if(this._isRendered())return this._getRenderedId();var e,b=document.createElement("div"),c=this._getCurrTemplate()||"",d=document.querySelector(this.options.parent);if(b.id=this._getRenderedId(!0),b.className="ui-mprogress",b.innerHTML=c,!this._isIndeterminateStyle()&&!this._isQueryStyle()){a||(e=!this._isStarted());var g=b.querySelector(this._getCurrSelector()),h=e?"-100":Utils.toBarPerc(this.status||0);if(Utils.setcss(g,{transition:"all 0 linear",transform:"translate3d("+h+"%,0,0)"}),this._isBufferStyle()){var i=b.querySelector(f),j=e?"-100":Utils.toBarPerc(this.bufferStatus||0);Utils.setcss(i,{transition:"all 0 linear",transform:"translate3d("+j+"%,0,0)"})}}return d!=document.body&&Utils.addClass(d,"mprogress-custom-parent"),d.appendChild(b),b},_remove:function(){var a=this._getRenderedId(),b=document.querySelector(this.options.parent);b!=document.body&&Utils.removeClass(b,"mprogress-custom-parent");var c=this.options.parent+this.options.template;i[c]&&(i[c]=null),a&&(this.status=null,this.bufferStatus=null,Utils.removeElement(a))},_setProgress:function(a,b){var c=this._render(),d=c.querySelector(a),e=this.options.speed,f=this.options.easing,g=this;return c.offsetWidth,this._isIndeterminateStyle()||this._isQueryStyle()?this:void Utils.queue(function(a){""===g.options.positionUsing&&(g.options.positionUsing=g._getPositioningCSS()),Utils.setcss(d,g._barPositionCSS(b,e,f)),1===b?(Utils.setcss(c,{transition:"none",opacity:1}),c.offsetWidth,setTimeout(function(){Utils.setcss(c,{transition:"all "+e+"ms linear",opacity:0}),setTimeout(function(){g._remove(),a()},e)},e)):setTimeout(a,e)})},_getCurrSelector:function(){var a=this._getCurrTplId();return a!==b?'[role="mpbar'+a+'"]':e},_isStarted:function(){return"number"==typeof this.status},_getRandomNum:function(a,b){return"number"!=typeof b&&(b=(1-a)*Utils.clamp(Math.random()*a,.1,.95)),a=Utils.clamp(a+b,0,.994)},_isRendered:function(){return!!this._getRenderedId()},_getRenderedId:function(a){var b=this._getCurrTplId(),c="mprogress"+b+"_"+this._inst;return a?c:document.getElementById(c)},_isBufferStyle:function(){return 2===this._getCurrTplId()},_isIndeterminateStyle:function(){return 3===this._getCurrTplId()},_isQueryStyle:function(){return 4===this._getCurrTplId()},_getCurrTplId:function(){var a=~~this.options.template||1;return"number"==typeof a?a:b},_getCurrTemplate:function(){var c,a=this.options.template||1,b=["determinate","buffer","indeterminate","query"];return"number"==typeof~~a?(c=b[a-1],h[c]||""):"string"==typeof a?template:void 0},_getPositioningCSS:function(){var a=document.body.style,b="WebkitTransform"in a?"Webkit":"MozTransform"in a?"Moz":"msTransform"in a?"ms":"OTransform"in a?"O":"";return b+"Perspective"in a?"translate3d":b+"Transform"in a?"translate":"margin"},_barPositionCSS:function(a,b,c){var d;return d="translate3d"===this.options.positionUsing?{transform:"translate3d("+Utils.toBarPerc(a)+"%,0,0)"}:"translate"===this.options.positionUsing?{transform:"translate("+Utils.toBarPerc(a)+"%,0)"}:{"margin-left":Utils.toBarPerc(a)+"%"},d.transition="all "+b+"ms "+c,d}},function(){var a=0,b=0;k.prototype.promise=function(c){if(!c||"resolved"==c.state())return this;var d=this;return 0==b&&d.start(),a++,b++,c.always(function(){b--,0==b?(a=0,d.end()):d.set((a-b)/a)}),this}}(),j});var MProgress_instances=0,DI_Personalization_Site={init_time:null,fade_time:500,max_geolocation_wait:4e3,hooks:{},init:function(){var a=this,b=0,c=[],d=[];this.init_time=new Date,jQuery(".di_personalize").each(function(){var e=jQuery(this);e.attr("id","di_personalize_"+b),e.css("text-align","center");var f=a.attrs(e),g=f.time/f.messages.length,h=a.get_default_message(f);"none"!=f.loading_type&&h&&(a.set_loading_message(f,g),"circle"==f.loading_type?a.add_loader_circle(f):a.add_loader_bar(f)),f.key=e.attr("key"),c.push(f),d.push(e.attr("key")),b++}),this.find_matches(d,c)},queryString:function(a){try{q=location.search.substring(1),v=q.split("&");for(var b=0;b<v.length;b++)if(p=v[b].split("="),p[0]==a)return p[1].indexOf("%20")!=-1?decodeURIComponent(p[1]):p[1]}catch(a){"undefined"!=typeof console&&console.log(a)}},find_matches:function(a,b){var c=this;if("undefined"!=typeof DIGeoLocation&&DIGeoLocation.stillLoading()&&this.max_geolocation_wait>0)return this.max_geolocation_wait-=100,void setTimeout(function(){c.find_matches(a,b)},100);var d=null;"undefined"!=typeof inventory_localization&&"undefined"!=typeof inventory_localization.vehicle&&(d=inventory_localization.vehicle);var e={type:"POST",url:di_personalize.ajax_url+"?action=personalize",data:{keys:a,slug:di_personalize.slug,referer:document.referrer,utm_source:this.queryString("utm_source"),utm_medium:this.queryString("utm_medium"),utm_campaign:this.queryString("utm_campaign"),utm_content:this.queryString("utm_content"),vehicle:d},dataType:"JSON"},f=function(a){c.fire_hook("pre_update"),a&&""==a.error&&a.items?c.update_original_content(b,a):c.use_all_default_messages(b),c.fire_hook("post_update")},g=function(){c.fire_hook("pre_update"),c.use_all_default_messages(b),c.fire_hook("post_update")},h=function(){jQuery.ajax(e).success(f).fail(g)};"complete"===document.readyState?h():jQuery(window).on("load",h)},update_original_content:function(a,b){for(var c=this,d={},e="",f=0;f<a.length;f++){var g=a[f].key;g in b.items?(e=b.items[a[f].key].match(/DI_PZ key='[^']+' tag='([^']+)'/),e[1]&&(e=e[1]),c.prepare_content(a[f],b.items[g])):(e="Default Shown",c.use_default_message(a[f])),a[f].tag=e,g in d||(d[g]=!0,this.track_shown_event(g,e))}},use_all_default_messages:function(a){for(var b=this,c=0;c<a.length;c++)b.use_default_message(a[c])},get_default_message:function(a){return jQuery("div.di_personalize_default",a.node).html()},track_shown_event:function(a,b){if("undefined"!=typeof dataLayer&&dataLayer&&a){var c={event:"personalization",eventCategory:"Personalization",eventAction:"Shown",eventLabel:"Key: "+a+" Tag:"+b+" Page:"+window.location.href};dataLayer.push(c)}},use_default_message:function(a){var b=this;b.prepare_content(a,this.get_default_message(a))},set_loading_message:function(a,b){var c=this;jQuery(".di_personalize_loading_message",a.node).html(a.messages.shift()),a.messages.length>0&&setTimeout(function(){c.set_loading_message(a,b)},b)},prepare_content:function(a,b){var c=this,d=new Date-this.init_time,e=a.time-d;e<=0?this.fadeout_placeholder(a,b):setTimeout(function(){c.fadeout_placeholder(a,b)},e)},fadeout_placeholder:function(a,b){var c=this;a.node=jQuery("#"+a.node.attr("id")),a.node.fadeOut(this.fade_time/2,function(){c.fadein_content(a,b)})},fadein_content:function(a,b){var d=a.key,e=a.tag;a.node.css("text-align","inherit"),a.node.html(b),jQuery("a",a.node).click(function(){DI_Personalization_Site.track_click_event(jQuery(this),d,e)}),a.node.fadeIn(this.fade_time/2),this.fire_hook("content_ready")},track_click_event:function(a,b,c){if("undefined"!=typeof dataLayer&&dataLayer&&b&&c){var d={event:"personalization-click",eventCategory:"Personalization",eventAction:"Click",eventLabel:"Key: "+b+" Tag:"+c+" Dest:"+a.attr("href")};dataLayer.push(d)}},attrs:function(a){var b=JSON.parse(jQuery(".di_personalize_customized",a).attr("data"));return"messages"in b||(b.messages=["Loading customized content..."]),"time"in b||(b.time=2),"size"in b||(b.size=30),"loading_type"in b||(b.loading_type="line"),b.node=jQuery(a),b},add_loader_circle:function(a){var b=2*a.size,c=a.size,d='<svg class="pz_loading_circle spinner" width="'+(b-1)+'px" height="'+(b-1)+'px" viewBox="0 0 '+b+" "+b+'" xmlns="http://www.w3.org/2000/svg"><circle class="pz_loading_circle path" cx="'+c+'" cy="'+c+'" r="'+(c-3)+'"></circle></svg>';a.node.prepend(d)},add_loader_bar:function(a){new Mprogress({template:3,start:!0,parent:"#"+a.node.attr("id")+" .di_personalize_customized"})},register_hook:function(a,b){a in this.hooks||(this.hooks[a]=[]),this.hooks[a].push(b)},fire_hook:function(a){if(a in this.hooks){for(var b=0;b<this.hooks[a].length;b++)this.hooks[a][b]();this.hooks[a]=[]}}};jQuery(document).ready(function(){DI_Personalization_Site.init()});