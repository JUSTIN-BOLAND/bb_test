function translateType(text){var is_fr=!!jQuery("body.lang-french").length,is_es=!!jQuery("body.lang-spanish").length;if(!is_fr&&!is_es)return text;switch(text){case"New":text=is_fr?"Neuf":"Nuevo";break;case"Used":case"Pre-Owned":text=is_fr?"d’occasion":"Usado";break;case"Certified Used":case"Certified Pre-Owned":text=is_fr?"d’occasion Certifiés":"Usado Certificado"}return text}jQuery(document).ready(function($){$(".filters-container").length>0&&"undefined"==typeof di_search_settings.filters&&jQuery.ajax({url:"/",type:"post",dataType:"json",data:{action:"im_ajax_call",perform:"homepage_search_filters"},success:function(filters){di_search_settings.filters=filters,$(".filters-container").each(function(index,element){var that=this;update_filters($(that)),$(that).find(":input").change(function(e){var reset="type[]"===$(this).attr("name");update_filters($(that),reset)}),$(that).find("input[type=button],button:not(.selectpicker),submit").click(function(e){var $search_field=DealerInspireSearchAnything.get_instance($(that).find("#search-anything-field,.alg-searc-class")),keyword="";"undefined"!=typeof $search_field.element&&(keyword=$search_field.element.val());var placeholder_text=$search_field.placeholder_text?$search_field.placeholder_text:di_search_settings.placeholder_text,selected_filters=[];try{var available_filters=$(that).find(":input,select").not("button,[type=submit],[type=text]");if(0===available_filters.length&&!keyword)throw"Nothing to search for!";$.each(available_filters,function(index,filter){var url_key=$(filter).attr("name")?$(filter).attr("name"):null;url_key&&jQuery.each([["years","year"],["makes","make"],["models","model"]],function(i,a){url_key=url_key.replace(a[0],a[1])});var key=$(filter).attr("name")?$(filter).attr("name").replace("[]","").replace(/s$/i,""):null,val=$(filter).val()?$(filter).val().toString():null;"radio"===filter.type&&$(filter).is(":checked")===!1||key&&val&&(selected_filters[key]={value:val,url_key:url_key})});var url="";if(url=di_get_search_redirect_url("undefined"==typeof selected_filters.type||keyword&&""!=keyword&&keyword!=placeholder_text?!1:selected_filters.type.value),keyword&&keyword!==placeholder_text){if($search_field.redirect_url!==!1)url=$search_field.redirect_url,$search_field.element.val("Loading...").attr("disabled","disabled");else{if(keyword.search(/new /i)!==-1?$search_field.type="New":keyword.search(/used |pre-owned |preowned /i)!==-1?$search_field.type="Used":keyword.search(/cpo |certified /i)!==-1&&($search_field.type="Certified Used"),$search_field.type?url=di_get_search_redirect_url($search_field.type):"undefined"!=typeof selected_filters.type&&(url=di_get_search_redirect_url(selected_filters.type.value)),url===!1)return!1;DealerInspireBrowserDetection.isFireFox()===!0&&keyword.search("&")>-1&&(filter.value=filter.value.replace(/&/g,"_AND_")),url+="&search="+keyword}(acf_redirect_url=di_get_homepage_acf_redirect_url(keyword))!==!1&&(url=acf_redirect_url)}else{if(url===!1)throw"Redirect URL is not set!";for(var key in selected_filters){var filter=selected_filters[key];"type"!==key&&filter.value&&(DealerInspireBrowserDetection.isFireFox()===!0&&filter.value.search("&")>-1&&(filter.value=filter.value.replace("&","_AND_")),filter.value.search(",")>-1?jQuery.each(filter.value.split(","),function(i,v){url+="&"+encodeURIComponent(filter.url_key)+"="+encodeURIComponent(v)}):url+="&"+encodeURIComponent(filter.url_key)+"="+encodeURIComponent(filter.value))}}return window.search_filters_redirect_url&&(url=search_filters_redirect_url(url,selected_filters,$search_field)),url!==!1&&(window.location.href=url,!1)}catch(e){return"undefined"!=typeof console&&console.log(e),!1}})})}})});var di_get_homepage_acf_redirect_url=function(search_term){if("undefined"==typeof di_homepage_acf_redirects||0===di_homepage_acf_redirects.length)return!1;var redirect_url=!1,redirects=jQuery.grep(di_homepage_acf_redirects,function(r){if(!r.terms||!r.redirect_url)return!1;if(jQuery.inArray(search_term.toLowerCase(),r.terms)>-1)return!0;var partial_match=!1;return jQuery.each(r.terms,function(i,term){if(2===(term.match(/%/g)||[]).length&&search_term.toLowerCase().indexOf(term.replace(/%/g,""))>-1)return partial_match=!0,!1}),partial_match});return jQuery.each(redirects,function(i,r){if(r.redirect_url)return redirect_url=r.redirect_url,!1}),redirect_url},di_get_search_redirect_url=function(type){var query="#action=im_ajax_call&perform=get_results&page=1",url="";try{if(!(di_search_settings.dealer_makes.indexOf("Honda")>-1||di_search_settings.dealer_makes.indexOf("Acura")>-1)||""!==di_search_settings.new_on_used&&""!==di_search_settings.used_on_new||(di_search_settings.used_vehicles_url=di_search_settings.new_vehicles_url),""===di_search_settings.new_vehicles_url&&""===di_search_settings.used_vehicles_url)throw"Please set New and Used pages in Site Configurations.";if(type&&"string"==typeof type&&type.indexOf(",")>-1&&(type=type.split(",")),type&&"object"==typeof type){var len=jQuery.map(type,function(n,i){return i}).length;1===len?url=di_get_search_redirect_url(type[0]):(url=di_search_settings.used_vehicles_url+query,jQuery.each(type,function(i,v){url+="&type%5B%5D="+encodeURIComponent(v)}))}else switch(type){case!1:case"":url=di_search_settings.used_vehicles_url+query+"&type%5B%5D=New&type%5B%5D=Used&type%5B%5D=Certified Used";break;case"New":url=""!==di_search_settings.new_vehicles_url?di_search_settings.new_vehicles_url+query:di_search_settings.used_vehicles_url+query+"&type%5B%5D=New";break;case"Used":url=di_search_settings.used_vehicles_url+query+"&type%5B%5D=Used&type%5B%5D=Certified Used";break;default:url=di_search_settings.used_vehicles_url+query+"&type%5B%5D="+encodeURIComponent(type)}""===url&&(url=(""!==di_search_settings.used_vehicles_url?di_search_settings.used_vehicles_url:di_search_settings.new_vehicles_url)+"#action=im_ajax_call&perform=get_results&page=1&type%5B%5D=New&type%5B%5D=Used&type%5B%5D=Certified Used")}catch(e){return"undefined"!=typeof console&&console.log(e),!1}return url},update_filters=function($container,reset){var $=jQuery,vehicles=JSON.parse(JSON.stringify(di_search_settings.filters)),container_filters=[];try{var available_filters=$container.find(":input,select").not("button,[type=submit],[type=text]");if(0===available_filters.length)throw"No filters were found in container!";if($.each(available_filters,function(index,filter){var key=$(filter).attr("name")?$(filter).attr("name").replace("[]","").replace(/s$/i,""):null,val=$(filter).val()?$(filter).val().toString():null,order=$(filter).data("order")?$(filter).data("order"):null,input_type=this.type;if(null!==key){switch(key){case"mile":key="miles",order=null===order?"range":order;break;case"price":order=null===order?"range":order;break;case"type":if(order=null===order?"vehicle-condition":order,"radio"===filter.type){if(val=$container.find(':input[type=radio][name="type[]"]:checked').val())break;if((""===di_search_settings.new_on_used||""===di_search_settings.used_on_new)&&!$(filter).val())return void $(filter).parent(".radio-button").remove();if(val||0!==$container.find(':input[type=radio][name="type[]"]:checked').length||($(filter).attr("checked","checked"),val=$(filter).val()),!val)return}break;case"year":order=null===order?"desc":order}null===order&&(order="asc"),reset===!0&&"type"!==key&&"hidden"!==input_type&&(val=null),container_filters.push({key:key,selected_value:val,values:[],order:order,element:$(filter),input_type:input_type})}}),0===container_filters.length)throw"Could not detect filters in container!";window.search_filters_object&&(vehicles=search_filters_object(vehicles,container_filters)),$.each(container_filters,function(index,filter){var current_key=(filter.selected_value,filter.key);$.each(vehicles,function(uid,vehicle){if("undefined"!=typeof vehicle[current_key]){var skip=!1,value=vehicle[current_key];value&&($.each(container_filters,function(fi,_filter){if(null!==_filter.selected_value&&_filter.key!==current_key){var _key=_filter.key;if("undefined"==typeof vehicle[_key])return skip=!0,!0;if("type"===_key&&"undefined"!=typeof di_search_settings.include_cpo_when_used_selected&&"enabled"===di_search_settings.include_cpo_when_used_selected&&"Used"===_filter.selected_value&&"Certified Used"===vehicle[_key]&&(vehicle[_key]="Used"),null!==_filter.selected_value)if("hidden"===_filter.input_type&&_filter.selected_value.search(",")>-1){if(_filter.selected_value.search(vehicle[_key])===-1)return skip=!0,!0}else if(_filter.selected_value!==vehicle[_key])return skip=!0,!0}}),skip===!1&&$.inArray(value,container_filters[index].values)===-1&&container_filters[index].values.push(value))}})}),$container.find("select option").each(function(index,element){""!==$(element).val()&&$(element).remove()});var filterValues=[];$.each(container_filters,function(index,filter){if(0!==filter.values.length){switch(filter.order){case"asc":filter.values.sort();break;case"desc":filter.values.sort().reverse();break;case"range":filter.values=searchSortArray(filter.values);break;case"vehicle-condition":}$.each(filter.values,function(i,v){if(filterValues.push(v),"object"==typeof filter.element&&filter.element.is("select")===!0){var text="type"===filter.key?v.replace("Used","Pre-Owned"):v;text=translateType(text),filter.element.append("<option value='"+v+"' "+(null!==filter.selected_value&&v===filter.selected_value?"selected='selected'":"")+">"+text+"</option>")}})}}),$("body").trigger("search_filters_rendered",[filterValues])}catch(e){"undefined"!=typeof console&&console.log(e.stack)}};jQuery("body.non-english").length&&jQuery("body").on("search_filters_rendered",function(e,filterVals){"undefined"==typeof di_search_settings.translated_values&&(di_search_settings.translated_values={},jQuery.ajax({url:"/",type:"POST",dataType:"json",data:{action:"im_ajax_call",perform:"translate_search_filters",filterVals:filterVals,_language_code:"object"==typeof icl_vars&&"en"!==icl_vars.current_language?icl_vars.current_language:""}}).done(function(data){"object"!=typeof data&&(data=window.JSON.parse(data)),di_search_settings.translated_values=data,jQuery("body").trigger("search_filters_rendered",[filterVals])})),"object"==typeof di_search_settings.translated_values&&jQuery.each(di_search_settings.translated_values,function(k,v){var $options=$('.filters-container option[value="'+k+'"]');$options.length&&(k.search(/pre-owned|new|used/i)>-1&&(v=translateType(k)),$options.text(v))})});var searchSortArray=function(arr){var n,tempArr=[];for(var i in arr){tempArr[i]=arr[i].match(/([^0-9]+)|([0-9]+)/g);for(var j in tempArr[i])isNaN(n=parseInt(tempArr[i][j]))||(tempArr[i][j]=n)}tempArr.sort(function(x,y){for(var i in x){if(y.length<i||x[i]<y[i])return-1;if(x[i]>y[i])return 1}return 0});for(var i in tempArr)arr[i]=tempArr[i].join("");return arr};