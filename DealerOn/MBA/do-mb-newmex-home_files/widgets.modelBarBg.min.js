(function($){$.fn.dealerOnResponsiveModelBarBg=function(options){var defaults={mb:"",mainFolderPath:stockPhotoPath+"photo/",modelBarThumbnailFolder:"pixt320",modelBarPopUpFolder:"pixt320"};var options=$.extend(defaults,options);var o=options;var responsiveModelBarParams;var modelBarArr=[];var modelBarCustomButtonArr=[];var modelBarButtonArr=[];var modelBarButtonLabelArr=[];var modelBarThumbnailsArr=[];var uniqueIDs=new Array();var thumbnailElm;var modelBarStyle=0;var photoType="mbDb";var extItem={};var modelBarTitle;var obj=$(this);if(o.mb!=""){responsiveModelBarParams=o.mb}modelBarArr=eval(responsiveModelBarParams.mb);modelBarCustomButtonArr=eval(responsiveModelBarParams.cmb);modelBarButtonArr=eval(responsiveModelBarParams.bt);modelBarButtonLabelArr=eval(responsiveModelBarParams.bl);modelBarThumbnailsArr=eval(responsiveModelBarParams.th);modelBarTitle=eval(responsiveModelBarParams.mbt);var modelBarThumbnailWidthMD=100/modelBarThumbnailsArr.tw;var modelBarThumbnailWidthSM=100/modelBarThumbnailsArr.th;var modelBarThumbnailAngle=modelBarThumbnailsArr.ta;var maxModelBarThumbnailWidth=Math.round((modelBarThumbnailWidthMD>=modelBarThumbnailWidthSM?1170*modelBarThumbnailWidthMD:749*modelBarThumbnailWidthSM)/100);return this.each(function(){activateModelBar()});function activateModelBar(){thumbnailElm=$("#modelBarWidgetBg");var mbPhotoThb;var mbPhotoPop;if(typeof(modelBarTitle)!="undefined"&&modelBarTitle.title!=""){thumbnailElm.prepend('<h2 class="sectionHeading margin-top-x">'+modelBarTitle.title+"</h2>")}$("head").append("<style>@media (min-width:992px) { .col-model-thumb { width:"+modelBarThumbnailWidthMD+"%; float: left; } } @media (max-width:991px) { .col-model-thumb { width:"+modelBarThumbnailWidthSM+"%; float: left; } }</style>");$.each(modelBarCustomButtonArr,function(i,item){if(item.hasOwnProperty("first")&&item.first=="true"){thumbnailElm.append(buildCustomButtons(i,item));thumbnailElm.find("a").last().click(function(){window.location=item.url})}});$.each(modelBarArr,function(i,item){extItem=modelBarExt(item);if(typeof(item.thuPhoto)!="undefined"){mbPhotoThb=item.thuPhoto}if(typeof(item.type)!="undefined"){photoType=item.type}var mbThumbId=validSelector(item.model);if($.inArray(mbThumbId,uniqueIDs)!=-1){mbThumbId=mbThumbId+uniqueIDs.length}uniqueIDs.push(mbThumbId);$("#modelBarWidget").addClass(modelBarThumbnailAngle);var vehAltTitle=item.year+" "+item.make+" "+extItem.mo;var thumbHTML='<div class="col-model-thumb">';thumbHTML+='<a id="'+mbThumbId+'" href=""> <div class="img-responsive carImage" role="img" aria-label="';thumbHTML+=vehAltTitle+'" style="background: url(\''+modelBarPhoto(mbPhotoThb,photoType)+"') no-repeat 50% 50% / contain; padding-top: 67.5%;\"></div>";if(modelBarThumbnailsArr.showYear==1||modelBarThumbnailsArr.showMake==1){thumbHTML+='<p class="mbTitleYearMake margin-bottom-x">';if(modelBarThumbnailsArr.showYear==1){thumbHTML+='<span class="mbTitleYear">'+item.year+"&nbsp;</span>"}if(modelBarThumbnailsArr.showMake==1){thumbHTML+='<span class="mbTitleMake">'+item.make+"</span>"}thumbHTML+="</p>"}thumbHTML+='<p class="mbTitleModel margin-bottom-x"><span>'+item.model+"</span></p>";if(modelBarThumbnailsArr.showMPG==1&&item.mpg!="0"){if(modelBarThumbnailsArr.showTag==1&&modelBarThumbnailsArr.tOp=="popup"){var mpglabel="MPG";if(item.tag.length>0){mpglabel+="*"}thumbHTML+='</a> <p class="mbTitleMPG margin-bottom-x">';thumbHTML+='<a id="'+mbThumbId+'Tip" data-original-title="'+item.tag+'" data-toggle="tooltip" title="" class="mbTagTooltip">';thumbHTML+='<span class="ttMpgValue">'+item.mpg+'&nbsp;</span><span class="ttMpgLabel">'+mpglabel+"</span></p>"}else{thumbHTML+='<p class="mbTitleMPG margin-bottom-x">';thumbHTML+='<span class="ttMpgValue">'+item.mpg+'&nbsp;</span><span class="ttMpgLabel">MPG</span></p>'}}if(modelBarThumbnailsArr.showTag==1&&modelBarThumbnailsArr.tOp=="under"){thumbHTML+='<p class="mbTitleTag margin-bottom-x"><span>'+item.tag+"</span>"}thumbHTML+="</a></p></div>";thumbnailElm.append((thumbHTML).replace(/vehAltTitle/gi,vehAltTitle));$("#"+mbThumbId).attr("href",ThumbnailClick(modelBarThumbnailsArr.url,item,extItem));$("#"+mbThumbId+"Tip").attr("href",ThumbnailClick(modelBarThumbnailsArr.url,item,extItem));$("#"+mbThumbId).click(function(e){DealerOnTrack.event("Model Bar Clicks",item.year+item.make+item.model,"Thumbnail Click")})});$.each(modelBarCustomButtonArr,function(i,item){if(!item.hasOwnProperty("first")||item.first=="false"){thumbnailElm.append(buildCustomButtons(i,item));thumbnailElm.find("a").last().click(function(){window.location=item.url})}})}function buildCustomButtons(i,item){var modelBarCustomButtonHtml="";var buttonImage=item.img;if(buttonImage.indexOf("assets/")>-1){buttonImage=buttonImage.substr(buttonImage.indexOf("assets/"))}if(buttonImage.match(/\.gif$/i)==null){buttonImage=cdnPath+"am/r/"+maxModelBarThumbnailWidth+"/"+buttonImage}else{buttonImage=cdnPath+buttonImage}modelBarCustomButtonHtml='<div class="col-model-thumb">';modelBarCustomButtonHtml+='<a id="'+item.id+'" class="mbCustomBtn"><div class="img-responsive carImage" role="img" alt="'+item.imgTitle+'" title="'+item.imgTitle+'" style="background: url(\''+buttonImage+"') no-repeat 50% 50% / contain; padding-top: 67.5%;\"></div>";if(!isEmpty(item.lbl)){modelBarCustomButtonHtml=modelBarCustomButtonHtml+'<p class="mbTitleModel margin-bottom-x"><span>'+item.lbl+"</span></p>"}modelBarCustomButtonHtml=modelBarCustomButtonHtml+"</a>";return modelBarCustomButtonHtml}function isEmpty(str){return(!str||0===str.length)}function validSelector(v){return v.replace(/[^\w-]/g,"-")}function modelBarPhoto(photo,type){var p="";p=photo.replace("sideview",modelBarThumbnailAngle);p=p.replace("pixt320",o.modelBarThumbnailFolder);if(type=="mbDb"){p=AssetsPath+"am/r/"+maxModelBarThumbnailWidth+"/photo/"+p}else{if(type=="mbCu"){if(p.indexOf("assets/")>-1){p=p.substr(p.indexOf("assets/"))}if(p.indexOf("pixt320/")>-1){p="/photo/"+p}p=AssetsPath+"am/r/"+maxModelBarThumbnailWidth+"/"+p}}return p.toLowerCase()}function modelBarExt(v){var ext=new Object();if(typeof(v.nm)!="undefined"){ext.nm=v.nm}else{ext.nm=v.model}if(typeof(v.um)!="undefined"){ext.um=v.um}else{ext.um=v.model}if(typeof(v.mo)!="undefined"){ext.mo=v.mo}else{ext.mo=v.model}if(typeof(v.tag)!="undefined"){ext.tag=v.tag}else{ext.tag=""}return ext}function ThumbnailClick(cUrl,v,ext){var newModel=v.model;var usedModel=v.model;var model=v.model;if(ext!=null){newModel=ext.nm;usedModel=ext.um}var filterNew="";var filterUsed="";if(newModel!=""){filterNew="?make="+v.make+"&model="+newModel.URIencode()}if(usedModel!=""){filterUsed="?make="+v.make+"&model="+usedModel.URIencode()}if(cUrl.indexOf("search")>-1){if(cUrl.indexOf("/")!=0){cUrl="/"+cUrl}if(cUrl.indexOf("used")>0){cUrl+=filterUsed}else{cUrl+=filterNew}}if(!window.DealeronCookie.hasItem("DLRON_coordinate")){return cUrl}if(sessionStorage.getItem("DLRON_coordinate_"+window.location.href+cUrl.split("?")[0].substring(1))==1){var location=trimLatLongCoordinate(window.DealeronCookie.getItem("DLRON_coordinate"));if(cUrl.indexOf("currentlocation")<0&&cUrl.indexOf("ZipCode")<0){if(cUrl.indexOf("?")===-1){cUrl+="?currentlocation="+location+"&st=Distance+asc,default"}else{cUrl+="&currentlocation="+location+"&st=Distance+asc,default"}}}return cUrl}}})(jQuery);String.prototype.URIencode=function(){if(this.length>0&&(this.indexOf("=")==-1)){return encodeURIComponent(this.trim().replace(/%26/g,"~-_")).replace(/%25/g,"%").replace(/%2C/g,",").replace(/%3D/g,"=").replace(/~-_/g,"%26").replace(/%20/g,"+")}else{if(this.indexOf("=")!=-1){return this.trim()}else{return encodeURIComponent(this)}}};if(typeof(responsiveModelBarBgParams)!="undefined"){$("#modelBarWidgetBg").dealerOnResponsiveModelBarBg({mb:responsiveModelBarBgParams});$('[data-toggle="tooltip"]').tooltip()}else{console.info("model bar params not found")};