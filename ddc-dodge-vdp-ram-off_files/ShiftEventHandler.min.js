"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};DDC.classes.namespace("tracking.shift.decorators"),tracking.shift.decorators.GlobalDecorator=function(t,e,i){tracking.framework.runtime.EventHandlerDecorator.call(this,t,e,i)},DDC.classes.extend(tracking.shift.decorators.GlobalDecorator,tracking.framework.runtime.EventHandlerDecorator),tracking.shift.decorators.GlobalDecorator.prototype.logCategory="GlobalDecorator",tracking.shift.decorators.GlobalDecorator.prototype.handleTypedSearch=function(t,e){this.delegate.handleTypedSearch(t,e.replace(/\s/g,"|"))},tracking.shift.decorators.GlobalDecorator.prototype.handleFormInitiation=function(t){return"INVENTORY_SEARCH"===t?void this.log.info("Consuming form initiation event"):void this.delegate.handleFormInitiation(t)},tracking.shift.decorators.GlobalDecorator.prototype.handleFormSubmission=function(t,e){return e&&"INVENTORY_SEARCH"!==t?void this.delegate.handleFormSubmission(t,e):void this.log.info("Consuming form submission event")},DDC.classes.namespace("tracking.shift.handlers"),tracking.shift.handlers.AbstractEventHandler=function(t,e){tracking.framework.runtime.EventHandler.call(this,t,e),this.scriptLocation=void 0,this.clientId=void 0,this.retailerId=void 0,this.providerId=void 0,this.formTrackingIdMapping={TEST_DRIVE:"Test Drive",INFO_REQUEST:"Request More Info",EMAIL_A_FRIEND:"Email a Friend",SPECIALS_EMAIL_A_FRIEND:"Email a Friend",CONTACT:"General Contact",PARTS_ORDER:"Parts",SERVICE_APPT:"Service",BODYSHOP:"Service",EMPLOYMENT:"Employment",TRADE_IN:"Trade In",FINANCE:"Finance",SPECIALS_INFO_REQUEST:"Specials",INVENTORYFINDER:"Vehicle Finder",MAKE_AN_OFFER:"Make an Offer",SHOWROOM:"Request More Info",VEHICLE_LEAD:"Request More Info",INVENTORY_SEARCH_LEAD:"Vehicle Finder",MSLP:"Request More Info",GLOBAL_VEHICLE_INCENTIVE_LEAD:"Specials",BUILD_AND_PRICE:"Get a Quote",EPRICE:"Get a Quote",DEFAULT:"Other"},this.inventoryTypeMapping={NEW:"New",USED:"Used",CERTIFIED:"CPO",ALL:"Mixed"},this.pageAliasMapping={"^INDEX$":"Home",".*INVENTORY_LISTING.*":"Vehicle Listing",".*HOURS.*":"Hours & Directions",".*DIRECTIONS.*":"Hours & Directions",".*INCENTIVES.*":"OEM Incentives","^AUTO_.*DETAILS.*":"Vehicle Details","^DEFAULT$":"Other"},this.pageName=void 0},DDC.classes.extend(tracking.shift.handlers.AbstractEventHandler,tracking.framework.runtime.EventHandler),tracking.shift.handlers.AbstractEventHandler.prototype.logCategory="AbstractEventHandler",tracking.shift.handlers.AbstractEventHandler.prototype.getScriptLocation=function(){return this.scriptLocation},tracking.shift.handlers.AbstractEventHandler.prototype.setScriptLocation=function(t){this.scriptLocation=t},tracking.shift.handlers.AbstractEventHandler.prototype.getClientId=function(){return this.clientId},tracking.shift.handlers.AbstractEventHandler.prototype.setClientId=function(t){this.clientId=t},tracking.shift.handlers.AbstractEventHandler.prototype.getRetailerId=function(){return this.retailerId},tracking.shift.handlers.AbstractEventHandler.prototype.setRetailerId=function(t){this.retailerId=t},tracking.shift.handlers.AbstractEventHandler.prototype.getProviderId=function(){return this.providerId},tracking.shift.handlers.AbstractEventHandler.prototype.setProviderId=function(t){this.providerId=t},tracking.shift.handlers.AbstractEventHandler.prototype.setPageAliasMapping=function(t){if(void 0!==t&&"object"===("undefined"==typeof t?"undefined":_typeof(t)))for(var e in t)t.hasOwnProperty(e)&&(this.pageAliasMapping[e]=t[e])},tracking.shift.handlers.AbstractEventHandler.prototype.initialize=function(){this.log.info("initializing..."),this.log.info("injecting "+this.scriptLocation+" into page"),function(t,e,i,r,n,a,o){t.ShiftAnalyticsObject=n,t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},t[n].l=1*new Date,a=e.createElement(i),o=e.getElementsByTagName(i)[0],a.async=1,a.src=r,o.parentNode.insertBefore(a,o)}(this.window,this.window.document,"script",this.scriptLocation,"sd"),this.log.info("sending create event"),this.window.sd("create",this.clientId,this.retailerId,this.providerId),this.log.info("initialized")},tracking.shift.handlers.AbstractEventHandler.prototype.mapFormTrackingId=function(t){t=t&&t.toUpperCase();var e=this.formTrackingIdMapping[t];return void 0===e&&(e=this.formTrackingIdMapping.DEFAULT),e},tracking.shift.handlers.AbstractEventHandler.prototype.mapInventoryType=function(t){t=t&&t.toUpperCase();var e=this.inventoryTypeMapping[t];return void 0===e&&(e=this.inventoryTypeMapping.DEFAULT),e},tracking.shift.handlers.AbstractEventHandler.prototype.mapPageAlias=function(t){t=t&&t.toUpperCase();for(var e in this.pageAliasMapping)if(this.pageAliasMapping.hasOwnProperty(e)&&void 0!==this.pageAliasMapping[e]&&t.match(e))return this.pageAliasMapping[e];return this.pageAliasMapping["^DEFAULT$"]},tracking.shift.handlers.AbstractEventHandler.prototype.buildDataForPageView=function(){return{}},tracking.shift.handlers.AbstractEventHandler.prototype.compositeTypeQueryFacet=function(t){if(t.compositeType)return t.compositeType;var e=this.page.currentPageAlias();return this.page.isVehicleListingPage(e)?this.page.isNewVehiclePage(e)?"new":this.page.isCertifiedUsedVehiclePage(e)?"certified":this.page.isUsedVehiclePage(e)?"used":"all":void 0},tracking.shift.handlers.AbstractEventHandler.prototype.sendData=function(t,e){var i=this;this.window.sd(function(){i.window.sdDataLayer=t}),void 0!==e?this.window.sd("send",e):this.window.sd("send")},tracking.shift.handlers.AbstractEventHandler.prototype.handlePageView=function(t){this.pageName=this.mapPageAlias(t);var e=this.buildDataForPageView(t);this.sendData(e,"pageview")},tracking.shift.handlers.AbstractEventHandler.prototype.handleSlideshowClick=function(t,e){this.sendData({carouselClick:{assetPosition:t,assetName:e},events:"carouselClick"})},DDC.classes.namespace("tracking.shift.handlers"),tracking.shift.handlers.ShiftEventHandler=function(t,e){tracking.shift.handlers.AbstractEventHandler.call(this,t,e)},DDC.classes.extend(tracking.shift.handlers.ShiftEventHandler,tracking.shift.handlers.AbstractEventHandler),tracking.shift.handlers.ShiftEventHandler.prototype.logCategory="ShiftEventHandler",tracking.shift.handlers.ShiftEventHandler.prototype.buildDataForPageView=function(t){var e={pageType:this.pageName,websiteTier:this.page.dataLayerProperty("site.siteInfo.tier"),language:this.page.dataLayerProperty("page.attributes.locale"),dealerZipCode:this.page.dataLayerProperty("dealership.postalCode"),dealerState:this.page.dataLayerProperty("dealership.stateProvince")};if(this.page.isVehicleDetailPage(t)){var i=this.page.dataLayerProperty("vehicles.0");e.vehicleDetails={status:this.mapInventoryType(i.inventoryType),year:i.modelYear,make:i.make,model:i.model,trim:i.trim,engine:i.engine,transmission:i.transmission,interiorColor:i.interiorColor,exteriorColor:i.exteriorColor,vin:i.vin,msrp:i.internetPrice,displayedPrice:i.internetPrice}}return e},tracking.shift.handlers.ShiftEventHandler.prototype.handleTypedSearch=function(t,e){this.sendData({formType:this.mapFormTrackingId(t),typedSearchContent:e,events:"typedSearch"})},tracking.shift.handlers.ShiftEventHandler.prototype.handleFormInitiation=function(t){this.sendData({formType:this.mapFormTrackingId(t),events:"formInitiation"})},tracking.shift.handlers.ShiftEventHandler.prototype.handleFormSubmission=function(t){this.sendData({leadId:this.page.dataLayerProperty("user.sessionId"),formType:this.mapFormTrackingId(t),events:"formSubmission"})},tracking.shift.handlers.ShiftEventHandler.prototype.handleOfferClick=function(t,e){this.sendData({offerClick:{offerId:t,offerName:e},events:"offerClick"})},tracking.shift.handlers.ShiftEventHandler.prototype.handleClickToCall=function(t){this.sendData({clickToCallDepartment:t,events:"clickToCall"})},tracking.shift.handlers.ShiftEventHandler.prototype.handleFilterSearch=function(t,e){var i=this.compositeTypeQueryFacet(e);this.sendData({countSearchResults:t,filterSearch:{status:this.mapInventoryType(i),year:void 0==e.year?"All":e.year,make:void 0==e.make?"All":e.make,model:void 0==e.model?"All":e.model,trim:void 0==e.trim?"All":e.trim,color:"All",minPrice:void 0==e.internetPrice?"All":e.internetPrice.split("-")[0],maxPrice:void 0==e.internetPrice?"All":e.internetPrice.split("-")[1],bodyStyle:void 0==e.bodyStyle?"All":e.bodyStyle,features:"All"},events:"filterSearch"})};